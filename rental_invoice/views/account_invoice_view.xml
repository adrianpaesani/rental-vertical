<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="invoice_form" model="ir.ui.view">
        <field name="name">account.invoice.form</field>
        <field name="model">account.invoice</field>
        <field name="inherit_id" ref="account.invoice_form" />
        <field name="arch" type="xml">
            <xpath expr="//group[field[@name='date_invoice']]" position="inside">
                <field name="origin_invoice" attrs="{'invisible': [('origin_invoice', '=', False)]}"/>
            </xpath>
        </field>
    </record>

    <record id="invoice_supplier_form" model="ir.ui.view">
        <field name="name">account.invoice.supplier.form</field>
        <field name="model">account.invoice</field>
        <field name="inherit_id" ref="account.invoice_supplier_form" />
        <field name="arch" type="xml">
            <xpath expr="//notebook/preceding-sibling::div[1]" position="before">
                <div class="oe_button_box" name="button_box">
                    <button
                        name="action_view_customer_invoices"
                        type="object"
                        class="oe_stat_button"
                        icon="fa-pencil-square-o"
                        attrs="{'invisible': [('customer_invoice_count', '=', 0)]}">
                        <field name="customer_invoice_count" widget="statinfo" string="Customer Invoices" />
                    </button>
                </div>
            </xpath>
            <header position="inside">
                <button
                    name="action_set_factual_check_succeeded"
                    string="Factual check succeeded"
                    type="object"
                    class="oe_highlight"
                    attrs="{'invisible': ['|', ('state', '!=', 'draft'), ('factually_correct', '=', 'yes')]}"
                    groups="rental_invoice.group_set_factual_check"
                />
                <button
                    name="action_set_factual_check_failed"
                    string="Factual check failed"
                    type="object"
                    class="oe_highlight"
                    attrs="{'invisible': ['|', ('state', '!=', 'draft'), ('factually_correct', '!=', False)]}"
                    groups="rental_invoice.group_set_factual_check"
                />
                <button
                    name="action_set_arithmetical_check_succeeded"
                    string="Arithmetical check succeeded"
                    type="object"
                    class="oe_highlight"
                    attrs="{'invisible': ['|', ('state', '!=', 'draft'), '|', ('factually_correct', '!=', 'yes'), ('arithmetically_correct', '=', 'yes')]}"
                    groups="rental_invoice.group_set_arithmetical_check"
                />
                <button
                    name="action_set_arithmetical_check_failed"
                    string="Arithmetical check failed"
                    type="object"
                    class="oe_highlight"
                    attrs="{'invisible': ['|', ('state', '!=', 'draft'), '|', ('factually_correct', '!=', 'yes'), ('arithmetically_correct', '!=', False)]}"
                    groups="rental_invoice.group_set_arithmetical_check"
                />
                <button
                    name="%(rental_invoice.action_create_customer_invoice)d"
                    string="Create Customer Invoice"
                    type="action"
                    class="oe_highlight"
                    attrs="{'invisible': ['|', ('customer_invoice_needed', '=', False), ('has_non_canceled_customer_invoices', '=', True)]}"
                    groups="rental_invoice.group_create_customer_invoice_from_vendor_bill"
                />
            </header>
            <button name="action_invoice_open" position="attributes">
                <attribute name="states"></attribute>
                <attribute name="attrs">
                    {'invisible': [
                        '|',
                        '&amp;',
                        ('customer_invoice_needed', '=', True),
                        ('has_non_canceled_customer_invoices', '=', False),
                        '|',
                        ('state', '!=', 'draft'),
                        '|',
                        ('factually_correct', '!=', 'yes'),
                        ('arithmetically_correct', '!=', 'yes'),
                    ]}
                </attribute>
            </button>
            <xpath expr="//group[field[@name='incoterm_id']]" position="inside">
                <field name="customer_invoice_needed" />
                <field name="has_non_canceled_customer_invoices" invisible="1" />
                <field name="factually_correct" readonly="1" />
                <field name="arithmetically_correct" readonly="1" />
            </xpath>
        </field>
    </record>

    <record id="view_account_invoice_filter" model="ir.ui.view">
        <field name="name">account.invoice.select</field>
        <field name="model">account.invoice</field>
        <field name="inherit_id" ref="account.view_account_invoice_filter" />
        <field name="arch" type="xml">
            <search position="inside">
                <filter name="to_be_factually_checked" string="to be factually checked" domain="[('factually_correct','=',False)]" />
                <filter name="to_be_arithmetically_checked" string="to be arithmetically checked" domain="[('arithmetically_correct','=',False)]" />
                <filter name="checked_failed" string="checked failed" domain="['|', ('factually_correct','=','no'), ('arithmetically_correct','=','no')]" />
            </search>
        </field>
    </record>
</odoo>
